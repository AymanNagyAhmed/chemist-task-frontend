(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9780:function(e,t,r){Promise.resolve().then(r.bind(r,5955))},2686:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return l},a:function(){return c}});var s=r(7437),a=r(2265),o=r(9376),n=r(1614);let i=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),d=(0,o.useRouter)();return(0,a.useEffect)(()=>{let e=(0,n.getCookie)("access_token"),t=(0,n.getCookie)("user_data");if(e&&t)try{l(JSON.parse(t))}catch(e){console.error("Failed to parse user data:",e)}u(!1)},[]),(0,s.jsx)(i.Provider,{value:{user:r,isLoading:c,login:(e,t)=>{(0,n.setCookie)("access_token",e),(0,n.setCookie)("user_data",JSON.stringify(t)),l(t)},logout:()=>{(0,n.deleteCookie)("access_token"),(0,n.deleteCookie)("user_data"),(0,n.deleteCookie)("userRegistered"),l(null),d.push("/")}},children:t})}let c=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5955:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var s=r(7437),a=r(2265),o=r(9376),n=r(2686),i=r(1229);let l=i.z.object({email:i.z.string().min(1,"Email is required").email("Invalid email address"),password:i.z.string().min(1,"Password is required").min(6,"Password must be at least 6 characters")});var c=r(4131);class u extends Error{constructor(e,t,r){super(e),this.status=t,this.path=r,this.name="AuthError"}}let d=async e=>{try{let t=await fetch("".concat("http://localhost:4000/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"});if(!t.ok){let e=await t.json();throw new u(e.message||"Login failed",t.status,"/api/auth/login")}let r=await t.json();return c.Z.set("access_token",r.data.access_token,{secure:!0,sameSite:"strict",path:"/"}),c.Z.set("user_data",JSON.stringify(r.data.user),{secure:!0,sameSite:"strict",path:"/"}),r}catch(e){if(console.error("Login service error:",e),e instanceof u)throw e;throw new u("Network error",500,"/api/auth/login")}};var m=r(1994),g=r(3335);let h=(0,a.forwardRef)((e,t)=>{let{className:r,children:a,isLoading:o,variant:n="primary",size:i="md",fullWidth:l,disabled:c,type:u="button",...d}=e;return(0,s.jsx)("button",{ref:t,type:u,disabled:c||o,className:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,g.m6)((0,m.W)(t))}("inline-flex items-center justify-center font-medium rounded-lg","transition-colors duration-200 ease-in-out","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500",ghost:"bg-transparent hover:bg-gray-100 focus:ring-gray-500"}[n],{sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-lg"}[i],l&&"w-full",r),...d,children:o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 mr-2 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Loading..."]}):a})});h.displayName="Button";let p=e=>{let{label:t,name:r,type:a="text",value:o,onChange:n,error:i,required:l,placeholder:c}=e;return(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{htmlFor:r,className:"block text-sm font-medium text-gray-700",children:t}),(0,s.jsx)("input",{id:r,name:r,type:a,value:o,onChange:n,required:l,className:"block w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900  focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-20",placeholder:c}),i&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-500",children:i})]})},f=()=>{let e=(0,o.useRouter)(),{login:t}=(0,n.a)(),[r,c]=(0,a.useState)(!1),[m,g]=(0,a.useState)({email:"user3@test.com",password:"123456789"}),[f,x]=(0,a.useState)({}),[y,b]=(0,a.useState)(""),w=e=>{let{name:t,value:r}=e.target;g(e=>({...e,[t]:r})),f[t]&&x(e=>({...e,[t]:""}))},j=async r=>{r.preventDefault(),c(!0),b(""),x({});try{let r=l.parse(m),s=await d(r);t(s.data.access_token,s.data.user),s.data.user.fullName?e.push("/user"):e.push("/user/register")}catch(e){if(console.error("Login error:",e),e instanceof i.jm){let t={};e.errors.forEach(e=>{let[r]=e.path;t[r]=e.message}),x(t)}else e instanceof u?b(e.message):b("An unexpected error occurred")}finally{c(!1)}};return(0,s.jsxs)("form",{onSubmit:j,className:"mt-8 space-y-6",role:"form",children:[(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsx)(p,{label:"Email address",name:"email",type:"email",value:m.email,onChange:w,error:f.email,required:!0,placeholder:"Enter your email"}),(0,s.jsx)(p,{label:"Password",name:"password",type:"password",value:m.password,onChange:w,error:f.password,required:!0,placeholder:"Enter your password"})]}),y&&(0,s.jsx)("div",{className:"p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-lg text-center",role:"alert",children:y}),(0,s.jsx)(h,{type:"submit",isLoading:r,fullWidth:!0,children:r?"Signing in...":"Sign in"})]})},x=()=>(0,s.jsxs)("div",{className:"text-center space-y-2",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back"}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Please sign in to your account"})]});function y(){return(0,s.jsx)("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-gray-50 to-gray-100",children:(0,s.jsx)("main",{className:"flex-grow flex items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"w-full max-w-md space-y-8 bg-white p-6 sm:p-8 md:p-10 rounded-2xl shadow-lg",children:[(0,s.jsx)(x,{}),(0,s.jsx)(f,{})]})})})}}},function(e){e.O(0,[229,571,971,117,744],function(){return e(e.s=9780)}),_N_E=e.O()}]);